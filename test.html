<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="d3.js"></script>
	<script type="text/javascript" src="/data/teams2.json"></script>
	<title></title>
</head>
<body>
	<select id="teams"></select>
	<script type="text/javascript">
		createDropdown();
	// Variables
		var body = d3.select('body')
		var h = 600
		var w = 1600
		var formatPercent = d3.format('.2%')
		var basketCoord = [10,50]
		var i = 0
		var plotData = []
		var line = d3.line().curve(d3.curveBundle.beta(0.9))
	// SVG
		var svgContainer = body.append('svg')
			.attr('height', h)
			.attr('width', w)

		var data = d3.csv("/data/warriors.csv").then(function(data) {
			data.forEach(function(d) { d['NEW_Y'] = +d['NEW_Y'],
						  			   d['LOC_X'] = +d['LOC_X']; 
									}); 
			// Scales
			var xScale = d3.scaleLinear()
				.domain([d3.min(data, function (d) {return d.NEW_Y - 50;}),
						 d3.max(data, function (d) {return d.NEW_Y + 50;})])
				.range([0, w]);

			var yScale = d3.scaleLinear()
				.domain([d3.min(data, function (d) {return d.LOC_X - 50;}),
						 d3.max(data, function (d) {return d.LOC_X + 300;})])
				.range([h, 0]);
			
			var curve = svgContainer.selectAll('path')
				.data(data)
				.enter()
				.append('path')
					.attr('d', function(d){
					return 	line([[xScale(d.NEW_Y), yScale(d.LOC_X)],
								  [xScale(d.NEW_Y), yScale(d.LOC_X + 400)],
								  [xScale(0), yScale(400)],
								  [xScale(0), yScale(150)]])})
					.attr("stroke", "black")
                    .attr("stroke-width", 0.1)
                    .attr("fill", "none")
                    .attr("opacity", 0.3)
					.attr("stroke-dasharray", function(){
						var length = this.getTotalLength();
						return length + " " + length;
					})
					.attr("stroke-dashoffset", function(){
						var length = this.getTotalLength();
						return length;
					})
					.transition()
						.duration(5000)
						.attr("stroke-dashoffset", 0)
		});	
		
		function updateData(team) {
			d3.csv("/data/"+ team +".csv").then(function(data) {
				data.forEach(function(d) { d['NEW_Y'] = +d['NEW_Y'],
						  			   d['LOC_X'] = +d['LOC_X']; 
				});		
			var xScale = d3.scaleLinear()
				.domain([d3.min(data, function (d) {return d.NEW_Y - 50;}),
						 d3.max(data, function (d) {return d.NEW_Y + 50;})])
				.range([0, w]);

			var yScale = d3.scaleLinear()
				.domain([d3.min(data, function (d) {return d.LOC_X - 50;}),
						 d3.max(data, function (d) {return d.LOC_X + 300;})])
				.range([h, 0]);	
				
			var svg = d3.select("body").transition();	
				svg.selectAll('path')
					.duration(2000)
					.attr('d', function(d){
						return 	line([[xScale(d.NEW_Y), yScale(d.LOC_X)],
									  [xScale(d.NEW_Y), yScale(d.LOC_X + 400)],
									  [xScale(0), yScale(400)],
									  [xScale(0), yScale(150)]])})
					.attr("stroke-dasharray", function(){
						var length = this.getTotalLength();
						return length + " " + length;
					})
					.attr("stroke-dashoffset", function(){
						var length = this.getTotalLength();
						return length;
					})
					.transition()
						.duration(5000)
						.attr("stroke-dashoffset", 0)
			});
		}

		function createDropdown() {
			debugger;
			var data = JSON.parse(teams2);
			debugger;
			//alert(teams.full_name["0"]);
		}
	</script>
	<div id="option">
	<input name="updateButton" 
           type="button" 
           value="Warriors" 
           onclick="updateData('warriors')" />
    <input name="updateButton" 
           type="button" 
           value="Rockets" 
           onclick="updateData('rockets')" />
	<input name="updateButton" 
           type="button" 
           value="Timberwolves" 
           onclick="updateData('wolves')" />
	</div>
</body>
</html>